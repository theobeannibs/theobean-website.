<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farmer Registration - Theobean Protocol</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo"><a href="/">THEOBEAN</a></div>
            <ul>
                <li><a href="/mission.html">Our Mission</a></li>
                <li><a href="/register.html">For Farmers</a></li>
                <li><a href="/login.html">For Investors</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section class="content-page">
            <h2>Join the Protocol</h2>
            <p>Register your farm to become part of a new, equitable supply chain. Secure your craft and your future.</p>
            <div class="form-container">
                <form id="farmer-registration-form">
                    <div id="form-feedback"></div>
                    <label for="name">Full Name:</label>
                    <input type="text" id="name" name="name" required>

                    <label for="phone">WhatsApp Phone Number:</label>
                    <input type="tel" id="phone" name="phone" required>

                    <label for="province">Province:</label>
                    <input type="text" id="province" name="province" required>

                    <button type="submit">Submit Registration</button>
                </form>
            </div>
        </section>
    </main>
    <footer>
        <p>&copy; 2025 Ethermento LLC. All rights reserved.</p>
    </footer>
    <script>
        document.getElementById('farmer-registration-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            const feedbackEl = document.getElementById('form-feedback');

            feedbackEl.textContent = 'Submitting...';
            feedbackEl.className = 'feedback-neutral';

            try {
                const response = await fetch('/.netlify/functions/register-farmer', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                if (!response.ok) throw new Error(result.message || 'An unknown error occurred.');
                
                feedbackEl.textContent = 'Registration successful! We will be in contact soon.';
                feedbackEl.className = 'feedback-success';
                form.reset();
            } catch (error) {
                feedbackEl.textContent = 'Error: ' + error.message;
                feedbackEl.className = 'feedback-error';
            }
        });
    </script>
</body>
</html>
